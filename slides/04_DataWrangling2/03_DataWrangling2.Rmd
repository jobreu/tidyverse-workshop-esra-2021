---
title: "Introduction to Survey Data Cleaning Using Tidyverse in R"
subtitle: "Data Wrangling - Part 2"
author: "Johannes Breuer<br />Stefan JÃ¼nger"
date: "2021-07-22"
location: "ESRA 2021"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "default-fonts", "workshop.css"]
    nature:
      highlightStyle: "github"
      highlightLines: true
      countIncrementalSlides: false
---
layout: true

```{r setup, include = F}
if (!require(easypackages)) install.packages("easypackages")
library(easypackages)

packages("knitr",
         "rmarkdown",
         "tidyverse",
         "gadenbuie/xaringanExtra",
         "gadenbuie/tweetrmd",
         "hadley/emo",
         "sctyner/memer",
         prompt = F)

options(htmltools.dir.version = FALSE,
        htmltools.preserve.raw = FALSE)

opts_chunk$set(echo = TRUE,
               fig.align = "center")

xaringanExtra::use_xaringan_extra(c("tile_view", "clipboard"))
xaringanExtra::use_extra_styles(hover_code_line = TRUE,
                                mute_unhighlighted_code = FALSE)
```

<div class="my-footer">
  <div style="float: left;"><span>`r gsub("<br />", ", ", gsub("<br /><br />|<a.+$", "", metadata$author))`</span></div>
  <div style="float: right;"><span>`r metadata$location`, `r metadata$date`</span></div>
  <div style="text-align: center;"><span>`r gsub(".+<br />", " ", metadata$subtitle)`</span></div>
</div>

---

## Data wrangling continued `r ji("cowboy_hat_face")`

While in the last session we focused on changing the structure of our data by **selecting**, **renaming**, and **relocating** columns and **filtering** and **arranging** rows, in this part we will focus on altering the content of data sets by *adding* and *changing* variables and variable values. More specifically, we will deal with...

- creating and computing new variables (in various ways)

- recoding the values of a variable

- dealing with missing values

```{r load data, echo = F, message = F}
gpc <- read_csv("../../data/ZA5667_v1-0-0_Stata14_synthetic-data.csv")
```

---

## `dplyr::mutate()`

```{r, mutate-cartoon, out.width = "60%", echo = F}
include_graphics("./pics/dplyr_mutate.png")
```
<small><small>Artwork by [Allison Horst](https://github.com/allisonhorst/stats-illustrations) </small></small>

---

## Creating a new variable

A simple example for creating a new variable is adding a numeric ID variable based on the row number in the data set.

.small[
```{r id}
gpc <- gpc %>% 
  mutate(id = row_number()) %>% #<<
  relocate(id, .before = everything()) # move the id column before all other columns

gpc %>% 
  select(1:5) %>% 
  glimpse
```
]

*Note*: The function `rowid_to_column()` from the `tibble` package is an alternative for this which also automatically includes the id variable as the first column.

---

class: center, middle

# [Exercise](https://jobreu.github.io/tidyverse-workshop-esra-2021/exercises/DataWrangling2_question.html) time `r ji("weight_lifting_woman")``r ji("muscle")``r ji("running_man")``r ji("biking_man")`

## [Solutions](https://jobreu.github.io/tidyverse-workshop-esra-2021/solutions/DataWrangling2_solution.html)